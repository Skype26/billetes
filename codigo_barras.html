<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de C√≥digo de Barras</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      background-color: #f0f0f0;
      text-align: center;
    }

    h1 {
      color: #333;
    }

    input[type="text"] {
      padding: 10px;
      font-size: 16px;
      width: 300px;
      margin-bottom: 20px;
    }

    table {
      width: 95%;
      margin: 0 auto 20px auto;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }

    th {
      background-color: #007bff;
      color: white;
    }

    .usado {
      background-color: #d4edda !important;
      color: #155724;
      pointer-events: none;
      opacity: 0.6;
    }

    button {
      padding: 6px 12px;
      font-size: 14px;
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }

    button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }

    #resetBtn {
      margin-top: 10px;
      background-color: #dc3545;
    }

    #resetBtn:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>

  <h1>Registro de C√≥digo de Barras</h1>

  <input type="text" id="inputEscaneo" placeholder="Escanea aqu√≠" autofocus>

  <table id="tablaCodigos">
    <thead>
      <tr>
        <th>#</th>
        <th>Denominaci√≥n</th>
        <th>C√≥digo</th>
        <th>Estado</th>
        <th>Fecha</th>
        <th>Acci√≥n</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button id="resetBtn" onclick="resetearEstados()">üîÑ Resetear estados</button>

  <script>
    const tablaBody = document.querySelector("#tablaCodigos tbody");

    // C√≥digos alfanum√©ricos fijos (sin prefijo de denominaci√≥n)
    const codigosTotales = [
      // 10 soles - 10 c√≥digos
      { denominacion: "10 soles", codigo: "A1B2C3" },
      { denominacion: "10 soles", codigo: "X9Y8Z7" },
      { denominacion: "10 soles", codigo: "K3L2M1" },
      { denominacion: "10 soles", codigo: "J5H6G7" },
      { denominacion: "10 soles", codigo: "Q1W2E3" },
      { denominacion: "10 soles", codigo: "R4T5Y6" },
      { denominacion: "10 soles", codigo: "U7I8O9" },
      { denominacion: "10 soles", codigo: "P0A9S8" },
      { denominacion: "10 soles", codigo: "D3F4G5" },
      { denominacion: "10 soles", codigo: "H6J7K8" },

      // 20 soles - 5 c√≥digos
      { denominacion: "20 soles", codigo: "M1N2B3" },
      { denominacion: "20 soles", codigo: "V4C5X6" },
      { denominacion: "20 soles", codigo: "Z7L8K9" },
      { denominacion: "20 soles", codigo: "B0N9M8" },
      { denominacion: "20 soles", codigo: "A7S6D5" },

      // 50 soles - 2 c√≥digos
      { denominacion: "50 soles", codigo: "Q8W7E6" },
      { denominacion: "50 soles", codigo: "R5T4Y3" },

      // 100 soles - 2 c√≥digos
      { denominacion: "100 soles", codigo: "U2I3O4" },
      { denominacion: "100 soles", codigo: "P5A6S7" },

      // 200 soles - 1 c√≥digo
      { denominacion: "200 soles", codigo: "Z1X2C3" }
    ];

    function obtenerUsados() {
      return JSON.parse(localStorage.getItem("codigosUsados")) || {};
    }

    function guardarUsados(usados) {
      localStorage.setItem("codigosUsados", JSON.stringify(usados));
    }

    function cargarTabla() {
      tablaBody.innerHTML = "";
      const usados = obtenerUsados();

      codigosTotales.forEach((item, index) => {
        const fila = document.createElement("tr");

        const celdaIndex = document.createElement("td");
        celdaIndex.textContent = index + 1;

        const celdaDenominacion = document.createElement("td");
        celdaDenominacion.textContent = item.denominacion;

        const celdaCodigo = document.createElement("td");
        celdaCodigo.textContent = item.codigo;

        const celdaEstado = document.createElement("td");
        const celdaFecha = document.createElement("td");
        const celdaAccion = document.createElement("td");
        const boton = document.createElement("button");
        boton.textContent = "Marcar como usado";

        const estaUsado = usados[item.codigo];

        if (estaUsado) {
          celdaEstado.textContent = "Usado";
          celdaFecha.textContent = estaUsado;
          fila.classList.add("usado");
          boton.disabled = true;
        } else {
          celdaEstado.textContent = "Disponible";
          celdaFecha.textContent = "-";
        }

        boton.onclick = () => {
          const fecha = new Date().toLocaleString();
          usados[item.codigo] = fecha;
          guardarUsados(usados);
          cargarTabla();
        };

        celdaAccion.appendChild(boton);
        fila.appendChild(celdaIndex);
        fila.appendChild(celdaDenominacion);
        fila.appendChild(celdaCodigo);
        fila.appendChild(celdaEstado);
        fila.appendChild(celdaFecha);
        fila.appendChild(celdaAccion);

        tablaBody.appendChild(fila);
      });
    }

    function resetearEstados() {
      if (confirm("¬øEst√°s seguro de que quieres resetear todos los estados?")) {
        localStorage.removeItem("codigosUsados");
        cargarTabla();
        document.getElementById("inputEscaneo").focus();
      }
    }

    document.getElementById("inputEscaneo").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        const codigoEscaneado = this.value.trim().toUpperCase();
        this.value = "";

        const usados = obtenerUsados();
        const encontrado = codigosTotales.find(item => item.codigo === codigoEscaneado);

        if (encontrado) {
          if (!usados[codigoEscaneado]) {
            usados[codigoEscaneado] = new Date().toLocaleString();
            guardarUsados(usados);
            cargarTabla();
            alert("‚úÖ C√≥digo marcado como usado: " + codigoEscaneado);
          } else {
            alert("‚ö†Ô∏è Este c√≥digo ya est√° marcado como usado.");
          }
        } else {
          alert("‚ùå C√≥digo no reconocido: " + codigoEscaneado);
        }
      }
    });

    cargarTabla();
  </script>

</body>
</html>
